define("alinw/uxcore-uploader/2.0.0/uploader",["jquery","spark-md5"],function(require,exports,module){var jQuery=require("jquery"),SparkMD5=require("spark-md5"),UXUploader=function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _srcContext=__webpack_require__(1),_srcContext2=_interopRequireDefault(_srcContext),_srcEvents=__webpack_require__(4),_srcEvents2=_interopRequireDefault(_srcEvents),_srcStatus=__webpack_require__(5),_srcStatus2=_interopRequireDefault(_srcStatus);exports["default"]=_srcContext2["default"],exports.Events=_srcEvents2["default"],exports.Status=_srcStatus2["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_events=__webpack_require__(4),_events2=_interopRequireDefault(_events),_status=__webpack_require__(5),_status2=_interopRequireDefault(_status),_errors=__webpack_require__(6),_filerequest=__webpack_require__(7),_filerequest2=_interopRequireDefault(_filerequest),_collectorDnd=__webpack_require__(8),_collectorDnd2=_interopRequireDefault(_collectorDnd),_collectorPaste=__webpack_require__(13),_collectorPaste2=_interopRequireDefault(_collectorPaste),_collectorPicker=__webpack_require__(14),_collectorPicker2=_interopRequireDefault(_collectorPicker),Context=function(_Emitter){function Context(options){var _this=this;_classCallCheck(this,Context),_get(Object.getPrototypeOf(Context.prototype),"constructor",this).call(this);var processThreads=options.processThreads,autoPending=options.autoPending,queueCapcity=options.queueCapcity,accept=options.accept,sizeLimit=options.sizeLimit,preventDuplicate=options.preventDuplicate,multiple=options.multiple;this.stat=new Stat,this.limiter=new Limiter,this.filter=new Filter,this.accept=accept,this.autoPending=autoPending,this.multiple=null==multiple?!0:multiple,this.pending=new Pending(processThreads),queueCapcity&&queueCapcity>0&&this.addLimit(function(){return _this.stat.getTotal()>=queueCapcity}),accept&&accept.length>0&&this.addFilter(function(file){if(accept){var allowed=accept.some(function(item){return item.extensions&&item.extensions.split(",").indexOf(file.ext)>-1});if(!allowed)return new _errors.FileExtensionError(file,file.ext+" is not allowed.")}}),sizeLimit&&sizeLimit>0&&this.addFilter(function(file){return file.size>sizeLimit?new _errors.FileSizeError(file,file.size+" is greater than limit:"+sizeLimit):void 0}),preventDuplicate&&this.addFilter(function(file){var has=_this.stat.getFiles().some(function(item){return item.name===file.name&&item.size===file.size});return has?new _errors.DuplicateError(file,file.name+" already in queue"):void 0}),this.requestOptions=options.request||{}}return _inherits(Context,_Emitter),_createClass(Context,[{key:"createFileRequest",value:function(file){return new _filerequest2["default"](file,this.requestOptions)}},{key:"isLimit",value:function(){return this.limiter.isLimit()}},{key:"addLimit",value:function(limit){return this.limiter.add(limit)}},{key:"addFilter",value:function(filter){return this.filter.add(filter)}},{key:"isAllow",value:function(file){return this.filter.filter(file)}},{key:"add",value:function(file){var _this2=this;return this.isLimit()?(this.emit(_events2["default"].QUEUE_ERROR,new _errors.QueueLimitError),!1):this.isAllow(file)?this.stat.add(file)?(file.setContext(this),file.setStatus(_status2["default"].QUEUED),file.on(_events2["default"].FILE_STATUS_CHANGE,function(status){status===_status2["default"].CANCELLED?_this2.stat.remove(file):status===_status2["default"].PENDING&&setTimeout(function(){_this2.pending.add(file)&&1===_this2.pending.size()&&_this2.emit(_events2["default"].QUEUE_UPLOAD_START)},1),_this2.emit(_events2["default"].QUEUE_STAT_CHANGE,_this2.stat),_this2.stat.getFiles(_status2["default"].PROCESS).length<1&&_this2.emit(_events2["default"].QUEUE_UPLOAD_END)}),this.emit(_events2["default"].QUEUE_ADD,file),this.emit(_events2["default"].QUEUE_STAT_CHANGE,this.stat),this.autoPending&&file.pending(),!0):(this.emit(_events2["default"].QUEUE_ERROR,new _errors.DuplicateError(file,file.name+" already in queue")),!1):(this.emit(_events2["default"].QUEUE_ERROR,this.filter.getError()),!1)}},{key:"setAutoPending",value:function(flag){this.autoPending=flag,this.autoPending&&this.stat.getFiles(_status2["default"].QUEUED).forEach(function(file){return file.pending()})}},{key:"setMultiple",value:function(flag){this.multiple=flag}},{key:"isMultiple",value:function(){return this.multiple}},{key:"getAccept",value:function(){return this.accept}},{key:"getStat",value:function(){return this.stat}},{key:"getPickerCollector",value:function(){return this.picker||(this.picker=new _collectorPicker2["default"](this)),this.picker}},{key:"getDndCollector",value:function(){return this.dnd||(this.dnd=new _collectorDnd2["default"](this)),this.dnd}},{key:"getPasteCollector",value:function(){return this.paster||(this.paster=new _collectorPaste2["default"](this)),this.paster}}],[{key:"setSWF",value:function(url){_collectorPicker2["default"].setSWF(url)}}]),Context}(_emitter2["default"]);exports["default"]=Context;var Set=function(){function Set(){_classCallCheck(this,Set),this._set=[]}return _createClass(Set,[{key:"shift",value:function(){return this._set.shift()}},{key:"pop",value:function(){return this._set.pop()}},{key:"toArray",value:function(){return this._set.slice(0)}},{key:"add",value:function(item){return this.has(item)?!1:(this._set.push(item),!0)}},{key:"has",value:function(item){return this._set.indexOf(item)>-1}},{key:"remove",value:function(item){var i=this._set.indexOf(item);return i>-1?(this._set.splice(i,1),!0):!1}},{key:"clear",value:function(){this._set=[]}},{key:"size",get:function(){return this._set.length}}]),Set}(),Stat=function(){function Stat(){_classCallCheck(this,Stat),this.files=new Set}return _createClass(Stat,[{key:"add",value:function(file){return this.files.add(file)}},{key:"remove",value:function(file){this.files.remove(file)}},{key:"getTotal",value:function(){return this.files.size}},{key:"getFiles",value:function(flag){var files=this.files.toArray();return flag?files.filter(function(file){return!!(file.getStatus()&flag)}):files}},{key:"stat",value:function stat(flag){var stat={},files=this.getFiles(flag);return files.forEach(function(file){var status=file.getStatus();stat[status]=status in stat?stat[status]+1:1}),stat.sum=files.length,stat}}]),Stat}(),Limiter=function(){function Limiter(){_classCallCheck(this,Limiter),this.limits=new Set}return _createClass(Limiter,[{key:"add",value:function(limit){return this.limits.add(limit),this}},{key:"remove",value:function(limit){return this.limits.remove(limit),this}},{key:"isLimit",value:function(){var _this3=this;return this.limits.toArray().some(function(fn){return fn.call(_this3)})}}]),Limiter}(),Filter=function(){function Filter(){_classCallCheck(this,Filter),this.filters=new Set}return _createClass(Filter,[{key:"add",value:function(filter){return this.filters.add(filter),this}},{key:"remove",value:function(filter){return this.filters.remove(filter),this}},{key:"filter",value:function(file){var _this4=this;return this.error=null,this.filters.toArray().every(function(filter){var ret=void 0;try{ret=filter(file)}catch(e){ret=e}return"string"==typeof ret?(_this4.error=new FilterError(file,ret),!1):ret instanceof Error?(_this4.error=ret instanceof FilterError?ret:new FilterError(file,ret.toString()),!1):!0})}},{key:"getError",value:function(){return this.error}}]),Filter}(),Pending=function(){function Pending(threads){_classCallCheck(this,Pending),this.threads=threads||2,this.heading=new Set,this.pending=new Set}return _createClass(Pending,[{key:"add",value:function(file){var _this5=this;return this.pending.add(file)?(file.session().always(function(){return _this5.pending.remove(file)}),this.load(),!0):!1}},{key:"size",value:function(){return this.pending.size+this.heading.size}},{key:"process",value:function(file){var _this6=this;this.heading.add(file)&&file.session().always(function(){_this6.heading.remove(file),_this6.load()})}},{key:"load",value:function(){for(var file;this.heading.size<this.threads&&(file=this.pending.shift());)file.prepare()&&this.process(file)}}]),Pending}();module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function HookInvoker(hooks,initialData,context){var _data=initialData,_error=null,_aborted=void 0,i=_jquery.Deferred(),ret=i.promise();ret.abort=function(){_aborted=!0};var fail=function(e){_aborted||(e&&(_error=e instanceof Error?e:new Error(e)),i.reject(_error||new Error("Unknown")))},done=function(){_aborted||(null!=_error?fail():i.resolve(_data))},setData=function(data){null==data||null!=_data&&data.constructor!==_data.constructor||(_data=data)},next=function next(data){if(!_aborted){if(data instanceof Error&&(_error=data),null!=_error)return fail();setData(data);var hook=hooks.shift();if(!hook)return done();var res=void 0;try{res=hook.call(context,_data)}catch(e){return fail(e)}res&&res.then?res.then(next,fail):next(res)}};return setTimeout(next,1),ret}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_jquery=__webpack_require__(3),Emitter=function(){function Emitter(){_classCallCheck(this,Emitter)}return _createClass(Emitter,[{key:"on",value:function(event,listener){return event=event.toLowerCase(),this._events||(this._events={}),this._events[event]||(this._events[event]=[]),this._events[event].push(listener),this}},{key:"once",value:function(event,listener){function fn(){that.off(event,fn),listener.apply(this,arguments)}event=event.toLowerCase();var that=this;return fn.listener=listener,this.on(event,fn),this}},{key:"off",value:function(event,listener){event=event.toLowerCase();var listeners=void 0;if(!this._events||!(listeners=this._events[event]))return this;for(var i=listeners.length;i-->0;)if(listeners[i]===listener||listeners[i].listener===listener){listeners.splice(i,1);break}return 0===listeners.length&&delete this._events[event],this}},{key:"removeAllListeners",value:function(event){return event?delete this._events[event.toLowerCase()]:this._events=[],this}},{key:"setPropagationTarget",value:function(emitter){emitter instanceof Emitter&&(this.propagationTarget=emitter)}},{key:"emit",value:function(event){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_len>_key;_key++)args[_key-1]=arguments[_key];return this.applyEmit(event,args),this}},{key:"applyEmit",value:function(event,args){var _this=this;event=event.toLowerCase();var listeners=void 0;if(this._events&&(listeners=this._events[event])&&listeners.slice(0).forEach(function(fn){return fn.apply(_this,args)}),this.propagationTarget){var pArgs=args.slice(0);pArgs.unshift(this),this.propagationTarget.applyEmit(event,pArgs)}return this}},{key:"invoke",value:function(event,data){event=event.toLowerCase();var listeners=void 0;return this._events&&(listeners=this._events[event])||(listeners=[]),HookInvoker(listeners.slice(0),data,this)}}]),Emitter}();exports["default"]=Emitter,module.exports=exports["default"]},function(module,exports){module.exports=jQuery},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={QUEUE_UPLOAD_START:"queueuploadstart",QUEUE_UPLOAD_END:"queueuploadend",QUEUE_ADD:"queueadd",QUEUE_ERROR:"queueerror",QUEUE_STAT_CHANGE:"statchange",FILE_UPLOAD_START:"fileuploadstart",FILE_UPLOAD_PREPARING:"fileuploadpreparing",FILE_UPLOAD_PREPARED:"fileuploadprepared",CHUNK_UPLOAD_PREPARING:"chunkuploadpreparing",CHUNK_UPLOAD_COMPLETING:"chunkuploadcompleting",FILE_UPLOAD_PROGRESS:"fileuploadprogress",FILE_UPLOAD_END:"fileuploadend",FILE_UPLOAD_COMPLETING:"fileuploadcompleting",FILE_UPLOAD_SUCCESS:"fileuploadsuccess",FILE_UPLOAD_ERROR:"fileuploaderror",FILE_UPLOAD_COMPLETED:"fileuploadcompleted",FILE_CANCEL:"filecancel",FILE_STATUS_CHANGE:"filestatuschange"},module.exports=exports["default"]},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={ALL:255,PROCESS:31,INITED:1,QUEUED:2,PENDING:4,PROGRESS:8,END:16,SUCCESS:32,ERROR:64,CANCELLED:128};var StatusName={1:"inited",2:"queued",4:"pending",8:"progress",16:"end",32:"success",64:"error",128:"cancelled"};exports.StatusName=StatusName},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},AbortError=function(_Error){function AbortError(message){_classCallCheck(this,AbortError),_get(Object.getPrototypeOf(AbortError.prototype),"constructor",this).call(this,message),this.name="AbortError"}return _inherits(AbortError,_Error),AbortError}(Error);exports.AbortError=AbortError;var TimeoutError=function(_Error2){function TimeoutError(message){_classCallCheck(this,TimeoutError),_get(Object.getPrototypeOf(TimeoutError.prototype),"constructor",this).call(this,message),this.name="TimeoutError"}return _inherits(TimeoutError,_Error2),TimeoutError}(Error);exports.TimeoutError=TimeoutError;var NetworkError=function(_Error3){function NetworkError(status,message){_classCallCheck(this,NetworkError),_get(Object.getPrototypeOf(NetworkError.prototype),"constructor",this).call(this,message),this.name="NetworkError",this.status=status}return _inherits(NetworkError,_Error3),NetworkError}(Error);exports.NetworkError=NetworkError;var QueueLimitError=function(_Error4){function QueueLimitError(){_classCallCheck(this,QueueLimitError),_get(Object.getPrototypeOf(QueueLimitError.prototype),"constructor",this).call(this,"queue limit"),this.name="QueueLimitError"}return _inherits(QueueLimitError,_Error4),QueueLimitError}(Error);exports.QueueLimitError=QueueLimitError;var FilterError=function(_Error5){function FilterError(file,message){_classCallCheck(this,FilterError),_get(Object.getPrototypeOf(FilterError.prototype),"constructor",this).call(this,message),this.name="FilterError",this.file=file}return _inherits(FilterError,_Error5),FilterError}(Error);exports.FilterError=FilterError;var DuplicateError=function(_FilterError){function DuplicateError(file,message){_classCallCheck(this,DuplicateError),_get(Object.getPrototypeOf(DuplicateError.prototype),"constructor",this).call(this,file,message),this.name="DuplicateError"}return _inherits(DuplicateError,_FilterError),DuplicateError}(FilterError);exports.DuplicateError=DuplicateError;var FileExtensionError=function(_FilterError2){function FileExtensionError(file,message){_classCallCheck(this,FileExtensionError),_get(Object.getPrototypeOf(FileExtensionError.prototype),"constructor",this).call(this,file,message),this.name="FileExtensionError"}return _inherits(FileExtensionError,_FilterError2),FileExtensionError}(FilterError);exports.FileExtensionError=FileExtensionError;var FileSizeError=function(_FilterError3){function FileSizeError(file,message){_classCallCheck(this,FileSizeError),_get(Object.getPrototypeOf(FileSizeError.prototype),"constructor",this).call(this,file,message),this.name="FileSizeError"}return _inherits(FileSizeError,_FilterError3),FileSizeError}(FilterError);exports.FileSizeError=FileSizeError},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ChunkResponse=function(){function ChunkResponse(rawResponse,chunkRequest){_classCallCheck(this,ChunkResponse),this.rawResponse=rawResponse,this.chunkRequest=chunkRequest}return _createClass(ChunkResponse,[{key:"getChunkRequest",value:function(){return this.chunkRequest}},{key:"getRawResponse",value:function(){return this.rawResponse}},{key:"getResponse",value:function(){return this.response||this.rawResponse}},{key:"getJson",value:function(){var response=this.getResponse();return null==response?null:"function"==typeof response.getJson?response.getJson():"string"==typeof response?""===response?null:JSON.parse(response):response}},{key:"setResponse",value:function(response){return this.response=response,this}}]),ChunkResponse}(),ChunkRequest=function(){function ChunkRequest(index,blob,fileRequest){_classCallCheck(this,ChunkRequest),this.index=index,this.blob=blob,this.fileRequest=fileRequest}return _createClass(ChunkRequest,[{key:"getName",value:function(){return this.fileRequest.getName()}},{key:"getFile",value:function(){return this.fileRequest.getFile()}},{key:"getBlob",value:function(){return this.blob}},{key:"getIndex",value:function(){return this.index}},{key:"isMultiChunk",value:function(){return this.getFile().source!==this.blob}},{key:"getParams",value:function(){return this.params||(this.params=this.fileRequest.getParams().clone()),this.params}},{key:"getParam",value:function(name){return this.getParams().getParam(name)}},{key:"setParam",value:function(name,value){return this.getParams().setParam(name,value),this}},{key:"getFileRequest",value:function(){return this.fileRequest}},{key:"getUrl",value:function(){return this.url||this.fileRequest.getUrl()}},{key:"setUrl",value:function(url){return this.url=url,this}},{key:"getHeaders",value:function(){return this.headers||(this.headers=this.fileRequest.getHeaders().slice(0)),this.headers}},{key:"setHeader",value:function(name,value){var headers=this.getHeaders();return headers.push({name:name,value:value}),this}},{key:"isWithCredentials",value:function(){return this.fileRequest.isWithCredentials()}},{key:"getTimeout",value:function(){return this.fileRequest.getTimeout()}},{key:"createChunkResponse",value:function(response){return new ChunkResponse(response,this)}}]),ChunkRequest}(),FileResponse=function(){function FileResponse(rawResponse,fileRequest){_classCallCheck(this,FileResponse),this.rawResponse=rawResponse,this.fileRequest=fileRequest}return _createClass(FileResponse,[{key:"isFromMultiChunkResponse",value:function(){return this.rawResponse instanceof ChunkResponse?this.rawResponse.getChunkRequest().isMultiChunk():!1}},{key:"getFileRequest",value:function(){return this.fileRequest}},{key:"getRawResponse",value:function(){return this.rawResponse}},{key:"getResponse",value:function(){return null!=this.response?this.response:this.rawResponse instanceof ChunkResponse?this.rawResponse.getResponse():this.rawResponse}},{key:"getJson",value:function(){var response=this.getResponse();return null==response?null:"function"==typeof response.getJson?response.getJson():"string"==typeof response?""===response?null:JSON.parse(response):response}},{key:"setResponse",value:function(response){return this.response=response,this}}]),FileResponse}(),Params=function(){function Params(params){if(_classCallCheck(this,Params),Array.isArray(params))this.params=params.slice(0);else if("object"==typeof params){this.params=[];for(var _name in params)params.hasOwnProperty(_name)&&this.params.push({name:_name,value:params[_name]})}else this.params=[]}return _createClass(Params,[{key:"setParam",value:function(name,value){this.removeParam(name),this.addParam(name,value)}},{key:"addParam",value:function(name,value){this.params.push({name:name,value:value})}},{key:"removeParam",value:function(name){this.params=this.params.filter(function(param){return param.name!==name})}},{key:"getParam",value:function(name,single){var ret=this.params.filter(function(param){return param.name===name}).map(function(param){return param.value});return single?ret.shift():ret}},{key:"clone",value:function(){return new Params(this.params)}},{key:"toArray",value:function(){return this.params}},{key:"toString",value:function(){var params=this.params.map(function(param){return encodeURIComponent(param.name)+"="+(null==param.value?"":encodeURIComponent(param.value))});return params.join("&")}}]),Params}(),MIN_CHUNK_SIZE=262144,FileRequest=function(){function FileRequest(file){var options=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,FileRequest),this.file=file,this.name=options.name||"file",this.url=options.url,this.params=new Params(options.params),this.headers=options.headers||[],this.withCredentials=options.withCredentials,this.timeout=options.timeout||0,this.chunkSize=options.chunkSize||0,this.chunkRetries=options.chunkRetries||0,this.chunkEnable=options.chunkEnable||!1,this.chunkProcessThreads=options.chunkProcessThreads||0}return _createClass(FileRequest,[{key:"getFile",value:function(){return this.file}},{key:"getUrl",value:function(){return this.url||""}},{key:"getName",value:function(){return this.name}},{key:"setName",value:function(name){return this.name=name,this}},{key:"setUrl",value:function(url){return this.url=url,this}},{key:"getParams",value:function(){return this.params}},{key:"getParam",value:function(name){return this.getParams().getParam(name)}},{key:"setParam",value:function(name,value){return this.params.setParam(name,value),this}},{key:"getHeaders",value:function(){return this.headers}},{key:"setHeader",value:function(name,value){this.headers.push({name:name,value:value})}},{key:"isWithCredentials",value:function(){return this.withCredentials}},{key:"setWithCredentials",value:function(flag){return this.withCredentials=flag,this}},{key:"getTimeout",value:function(){return this.timeout}},{key:"setTimeout",value:function(timeout){return this.timeout=timeout,this}},{key:"getChunkSize",value:function(){return this.chunkSize}},{key:"setChunkSize",value:function(chunkSize){return this.chunkSize=chunkSize,this}},{key:"getChunkRetries",value:function(){return this.chunkRetries}},{key:"setChunkRetries",value:function(retries){return this.chunkRetries=retries,0}},{key:"isChunkEnable",value:function(){return this.chunkEnable&&this.chunkSize>MIN_CHUNK_SIZE&&this.file.getRuntime().canSlice()&&this.file.size>this.chunkSize}},{key:"setChunkEnable",value:function(flag){return this.chunkEnable=flag,this}},{key:"getChunkProcessThreads",value:function(){return this.chunkProcessThreads}},{key:"setChunkProcessThreads",value:function(threads){return this.chunkProcessThreads=threads,this}},{key:"createChunkRequest",value:function(index,blob){return new ChunkRequest(index,blob,this)}},{key:"createFileResponse",value:function(response){return new FileResponse(response,this)}}]),FileRequest}();exports["default"]=FileRequest,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function createReader(collector){function reader(dataTransfer,responders){for(var item,items=dataTransfer.items,files=dataTransfer.files,i=0,l=files.length;l>i;i++){item=items&&items[i];var entry=item&&item.webkitGetAsEntry&&item.webkitGetAsEntry();entry&&entry.isDirectory?readEntry(entry,responders):collector(files[i],responders)}}function readEntry(entry,responders){entry.isFile?entry.file(function(file){return collector(file,responders)}):entry.isDirectory&&entry.createReader().readEntries(function(entries){for(var i=0,l=entries.length;l>i;i++)readEntry(entries[i],responders)})}return reader}function prepare(){var $doc=_jquery2["default"](document),runtime=_html5Runtime2["default"].getInstance(),started=0,enter=0,endTimer=void 0,dataTransferReader=createReader(function(file,responders){!responders||responders.length<1||(file=new _file2["default"](runtime,file),responders.some(function(responder){return responder.recieve(file)}))}),start=function(e){started=1,Collectors.forEach(function(responder){return responder.start(e)})},move=function(e){var allowed=Collectors.filter(function(responder){return responder.response(e)}),dataTransfer=(e.originalEvent||e).dataTransfer;dataTransfer&&(dataTransfer.dropEffect=allowed.length?"copy":"none"),e.preventDefault()},end=function(e){started=0,enter=0,Collectors.forEach(function(responder){return responder.end(e)})},drag=function(e){clearTimeout(endTimer);var isLeave="dragleave"===e.type;isLeave||started||start(e),move(e),isLeave&&(endTimer=setTimeout(function(){return end(e)},100))},drop=function(e){e.preventDefault(),clearTimeout(endTimer),end(e);var responders=Collectors.filter(function(responder){return responder.contains(e.target)});if(!(responders.length<1)){var dataTransfer=(e.originalEvent||e).dataTransfer;try{if(dataTransfer.getData("text/html"))return}catch(ex){}dataTransferReader(dataTransfer,responders)}};$doc.on("dragenter dragover dragleave",drag),$doc.on("drop",drop)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_jquery=__webpack_require__(3),_jquery2=_interopRequireDefault(_jquery),_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_html5Runtime=__webpack_require__(9),_html5Runtime2=_interopRequireDefault(_html5Runtime),_file=__webpack_require__(12),_file2=_interopRequireDefault(_file),Area=function(_Emitter){function Area(area){_classCallCheck(this,Area),_get(Object.getPrototypeOf(Area.prototype),"constructor",this).call(this),this.areaElement=area}return _inherits(Area,_Emitter),_createClass(Area,[{key:"contains",value:function(target){return this.areaElement.contains(target)}},{key:"start",value:function(e,allowed){this.emit("start",e,allowed)}},{key:"response",value:function(e,allowed){return allowed=allowed&&this.contains(e.target),this.emit("response",e,allowed),allowed}},{key:"end",value:function(e){this.emit("end",e)}}]),Area}(_emitter2["default"]),Collectors=[],DndCollector=function(){function DndCollector(context){_classCallCheck(this,DndCollector),Collectors.length<1&&prepare(),Collectors.push(this),this.context=context,this.areas=[]}return _createClass(DndCollector,null,[{key:"isSupport",value:function(){return"DataTransfer"in window&&"FileList"in window}}]),_createClass(DndCollector,[{key:"addArea",value:function(area){var _this=this;return area=new Area(area),this.areas.push(area),area.destroy=function(){area.removeAllListeners();var i=_this.areas.indexOf(area);i>-1&&_this.areas.splice(i,1)},area}},{key:"contains",value:function(target){return this.areas.some(function(area){return area.contains(target)})}},{key:"start",value:function(e){var allowed=!this.context.isLimit();
this.areas.forEach(function(area){return area.start(e,allowed)})}},{key:"response",value:function(e){var allowed=!this.context.isLimit(),res=this.areas.map(function(area){return area.response(e,allowed)});return allowed&&res.some(function(r){return!!r})}},{key:"recieve",value:function(file){return this.context.add(file)}},{key:"end",value:function(e){this.areas.forEach(function(area){return area.end(e)})}}]),DndCollector}();exports["default"]=DndCollector,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_jquery=__webpack_require__(3),_runtime=__webpack_require__(10),_runtime2=_interopRequireDefault(_runtime),_transport=__webpack_require__(11),_transport2=_interopRequireDefault(_transport),instance=void 0,Html5Runtime=function(_Runtime){function Html5Runtime(){_classCallCheck(this,Html5Runtime),_get(Object.getPrototypeOf(Html5Runtime.prototype),"constructor",this).apply(this,arguments)}return _inherits(Html5Runtime,_Runtime),_createClass(Html5Runtime,[{key:"getAsDataUrl",value:function(blob,timeout){var i=_jquery.Deferred(),fr=new FileReader,timer=void 0;fr.onloadend=function(){fr.readyState==FileReader.DONE?i.resolve(fr.result):i.reject(),clearTimeout(timer),fr.onloadend=null},fr.readAsDataURL(blob);var abort=function(){fr&&fr.abort(),fr=null};timeout&&(timer=setTimeout(abort,timeout));var ret=i.promise();return ret.abort=abort,ret}},{key:"getTransport",value:function(){return this.transport||(this.transport=new _transport2["default"](this)),this.transport}},{key:"canSlice",value:function(){return!!(Blob.prototype.slice||Blob.prototype.mozSlice||Blob.prototype.webkitSlice)}},{key:"slice",value:function(blob,start,end){var blobSlice=blob.slice||blob.mozSlice||blob.webkitSlice;return blobSlice.call(blob,start,end)}},{key:"md5",value:function(blob){var i=_jquery.Deferred();if(!window.SparkMD5)return i.reject(),i.promise();var chunkSize=2097152,chunks=Math.ceil(blob.size/chunkSize),chunk=0,spark=new SparkMD5.ArrayBuffer,blobSlice=blob.mozSlice||blob.webkitSlice||blob.slice,fr=new FileReader,_loadNext=function(){if(fr){var start=void 0,end=void 0;start=chunk*chunkSize,end=Math.min(start+chunkSize,blob.size),fr.onload=function(){spark&&spark.append(fr.result)},fr.onloadend=function(){fr&&(fr.readyState==FileReader.DONE?++chunk<chunks?setTimeout(_loadNext,1):setTimeout(function(){spark&&i.resolve(spark.end()),_loadNext=blob=spark=null},50):i.reject(),fr.onloadend=fr.onload=null)},fr.readAsArrayBuffer(blobSlice.call(blob,start,end))}};_loadNext();var ret=i.promise();return ret.abort=function(){fr&&fr.abort(),spark=null,fr=null},ret}}],[{key:"getInstance",value:function(){return instance||(instance=new Html5Runtime),instance}}]),Html5Runtime}(_runtime2["default"]);exports["default"]=Html5Runtime,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_events=__webpack_require__(4),_events2=_interopRequireDefault(_events),_errors=__webpack_require__(6),_jquery=__webpack_require__(3),Runtime=function(_Emitter){function Runtime(){_classCallCheck(this,Runtime),_get(Object.getPrototypeOf(Runtime.prototype),"constructor",this).apply(this,arguments)}return _inherits(Runtime,_Emitter),_createClass(Runtime,[{key:"md5",value:function(blob){var i=_jquery.Deferred();return i.reject(),i.promise()}},{key:"getAsDataUrl",value:function(file,timeout){var i=_jquery.Deferred();return i.reject(),i.promise()}},{key:"getTransport",value:function(){return null}},{key:"getUploading",value:function(){return this.uploading||(this.uploading=new Uploading(this)),this.uploading}},{key:"canSlice",value:function(){return!1}},{key:"slice",value:function(blob){throw new Error("this runtime current not support slice")}},{key:"cancel",value:function(blob){}}]),Runtime}(_emitter2["default"]);exports["default"]=Runtime;var Uploading=function(){function Uploading(runtime){_classCallCheck(this,Uploading),this.runtime=runtime}return _createClass(Uploading,[{key:"generate",value:function(request){var _this=this,i=_jquery.Deferred(),file=request.getFile(),runtime=this.runtime,source=file.getSource(),size=file.size,chunkSize=request.getChunkSize(),useChunk=request.isChunkEnable(),threads=request.getChunkProcessThreads(),start=0,end=0,slots=[],getActives=function(){return slots.reduce(function(sum,slot){return sum+("pending"===slot.state()?1:0)},0)},readChunk=function(){for(var slot=void 0,req=void 0,blob=void 0;size>end&&getActives()<threads;)start=end,end=Math.min(end+chunkSize,size),blob=runtime.slice(source,start,end),req=request.createChunkRequest(slots.length,blob),slot=_this.slot(req,request.getChunkRetries()),slot.progress(progress).done(done).fail(fail),slots.push(slot)},progress=function(){var total=size-end,loaded=0;slots.forEach(function(slot){total+=slot.total,loaded+=slot.loaded}),i.notify({total:total,loaded:loaded})},done=function(res){useChunk&&readChunk(),end>=size&&slots.every(function(slot){return"resolved"===slot.state()})&&i.resolve(res)},abort=function(){slots.forEach(function(slot){return slot.abort()})},fail=function(error){i.reject(error),abort()};if(useChunk)readChunk();else{end=size;var slot=this.slot(request.createChunkRequest(0,source),0);slot.progress(progress).done(done).fail(fail),slots.push(slot)}var ret=i.promise();return ret.abort=abort,ret}},{key:"slot",value:function slot(request,retries){var i=_jquery.Deferred(),runtime=this.runtime,context=request.getFile().getContext(),slot=i.promise(),progress=function(e){e.total&&(slot.total=e.total),e.loaded&&(slot.loaded=e.loaded),i.notify(e)},process=function(){var prepare,transport,completion;slot.abort=function(){prepare&&prepare.abort(),transport&&transport.abort(),completion&&completion.abort()},slot.total=request.getBlob().size,slot.loaded=0,prepare=context.invoke(_events2["default"].CHUNK_UPLOAD_PREPARING,request),prepare.then(function(request){return transport=runtime.getTransport().generate(request),transport.progress(progress),transport}).then(function(response){return completion=context.invoke(_events2["default"].CHUNK_UPLOAD_COMPLETING,request.createChunkResponse(response))}).done(i.resolve).fail(error)},error=function(e){e instanceof _errors.NetworkError&&retries-->0?setTimeout(process,500):i.reject(e),slot.abort()};return process(),slot}}]),Uploading}();module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_errors=__webpack_require__(6),_jquery=__webpack_require__(3),Html5Transport=function(){function Html5Transport(){_classCallCheck(this,Html5Transport)}return _createClass(Html5Transport,[{key:"generate",value:function(request){var i=_jquery.Deferred(),timeoutTimer=void 0,withCredentials=!1,xhr=new XMLHttpRequest;request.isWithCredentials&&!("withCredentials"in xhr)&&"XDomainRequest"in window&&(xhr=new XDomainRequest,withCredentials=!0);var clean=function(){xhr.onload=xhr.onerror=null,xhr.upload&&(xhr.upload.onprogress=null),timeoutTimer&&clearTimeout(timeoutTimer)},abort=function(){clean();try{xhr.abort()}catch(e){}},complete=function(e){return clean(),xhr.status||"error"!==e.type?0===xhr.status||304===xhr.status||xhr.status>=200&&xhr.status<300?i.resolve(xhr.responseText):i.reject(new _errors.NetworkError(xhr.status,xhr.statusText)):i.reject(new _errors.AbortError(e.message))};xhr.upload&&(xhr.upload.onprogress=function(e){return i.notify(e)}),xhr.onerror=complete,xhr.onload=complete;var timeout=request.getTimeout();timeout>0&&(timeoutTimer=setTimeout(function(){abort(),i.reject(new _errors.TimeoutError("timeout:"+timeout))},timeout));try{!function(){withCredentials?(xhr.open("POST",request.getUrl(),!0),xhr.withCredentials=!0):xhr.open("POST",request.getUrl()),request.getHeaders().forEach(function(header){return xhr.setRequestHeader(header.name,header.value)});var formData=new FormData,blob=request.getBlob();request.getParams().toArray().forEach(function(param){return formData.append(param.name,param.value)}),formData.append(request.getName(),blob,blob.name||"blob"),xhr.send(formData)}()}catch(e){abort(),i.reject(new _errors.AbortError(e.message))}var ret=i.promise();return ret.abort=abort,ret}}]),Html5Transport}();exports["default"]=Html5Transport,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function guid(){return"FILE-"+(uid++).toString(16).toUpperCase()}function guessExt(blob){var m=blob.name&&RE_EXT.exec(blob.name);return m?m[1]:(m=blob.type&&RE_IMAGE.exec(blob.type),m?m[1]:"")}function guessType(ext){return["jpg","jpeg","png","gif","bmp"].indexOf(ext.toLowerCase())?"image/"+("jpg"===ext?"jpeg":ext):null}Object.defineProperty(exports,"__esModule",{value:!0});var _get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_events=__webpack_require__(4),_events2=_interopRequireDefault(_events),_status=__webpack_require__(5),_status2=_interopRequireDefault(_status),_jquery=__webpack_require__(3),uid=0,RE_EXT=/\.([^.]+)$/,RE_IMAGE=/\/(jpg|jpeg|png|gif|bmp)$/i,Progress=function(){function Progress(total,loaded){_classCallCheck(this,Progress),this.total=total,this.loaded=loaded}return _createClass(Progress,[{key:"percentage",get:function(){return this.loaded===this.total?100:Math.ceil(this.loaded/this.total*100)}}]),Progress}();exports["default"]=Progress;var File=function(_Emitter){function File(runtime,source,filename){_classCallCheck(this,File),_get(Object.getPrototypeOf(File.prototype),"constructor",this).call(this),this.id=guid(),this.name=source.name||filename||this.id;var ext=guessExt(source).toLowerCase();ext&&!RE_EXT.test(this.name)&&(this.name+="."+ext),this.ext=ext,this.type=source.type||guessType(this.ext)||"application/octet-stream",this.lastModified=source.lastModified||+new Date,this.size=source.size||0,this.runtime=runtime,this.source=source,this.status=_status2["default"].INITED,this.progress=new Progress(this.size,0)}return _inherits(File,_Emitter),_createClass(File,[{key:"getContext",value:function(){return this.context}},{key:"setContext",value:function(context){this.context=context,this.setPropagationTarget(context)}},{key:"getRuntime",value:function(){return this.runtime}},{key:"isImage",value:function(){return RE_IMAGE.test(this.type)}},{key:"setStatus",value:function(status){var prevStatus=this.status;prevStatus!==_status2["default"].CANCELLED&&status!==prevStatus&&(this.status=status,this.emit(_events2["default"].FILE_STATUS_CHANGE,status,prevStatus))}},{key:"getStatus",value:function(){return this.status}},{key:"getStatusName",value:function(){return this.status in _status.StatusName?_status.StatusName[this.status]:"unknow"}},{key:"getSource",value:function(){return this.source}},{key:"getAsDataUrl",value:function(timeout){return this._dataUrlPromise||(this._dataUrlPromise=this.runtime.getAsDataUrl(this.source,timeout)),this._dataUrlPromise}},{key:"md5",value:function(){return this._md5Promise||(this._md5Promise=this.runtime.md5(this.source)),this._md5Promise}},{key:"session",value:function session(){var _this=this;if(this._sessionPromise)return this._sessionPromise;var session=_jquery.Deferred();return session.progress(function(progress){_this.setStatus(_status2["default"].PROGRESS),_this.emit(_events2["default"].FILE_UPLOAD_PROGRESS,progress)}).done(function(response){_this.response=response,_this._session=null,_this._sessionPromise=null,_this._flows=[],_this.setStatus(_status2["default"].SUCCESS),_this.emit(_events2["default"].FILE_UPLOAD_SUCCESS,response)}).fail(function(error){_this._session=null,_this._sessionPromise=null;for(var flow=void 0;flow=_this._flows.shift();)flow.abort();error instanceof Error&&(_this.setStatus(_status2["default"].ERROR),_this.emit(_events2["default"].FILE_UPLOAD_ERROR,error))}).always(function(){_this.emit(_events2["default"].FILE_UPLOAD_COMPLETED,_this.getStatus())}),this._flows=[],this._session=session,this._sessionPromise=session.promise(),this._sessionPromise}},{key:"prepare",value:function prepare(){var _this2=this;if(this.status!==_status2["default"].PENDING||!this.context)return!1;this.session(),this.setStatus(_status2["default"].PROGRESS),this.emit(_events2["default"].FILE_UPLOAD_START),this.request=this.context.createFileRequest(this);var prepare=this.context.invoke(_events2["default"].FILE_UPLOAD_PREPARING,this.request);return this._flows.push(prepare),prepare.then(function(request){_this2.emit(_events2["default"].FILE_UPLOAD_PREPARED,request);var upload=_this2.runtime.getUploading().generate(request);return _this2._flows.push(upload),upload.progress(function(e){_this2.progress.total=e.total,_this2.progress.loaded=e.loaded,_this2._session.notify(_this2.progress)}),upload}).then(function(response){return _this2.complete(response)},this._session.reject),!0}},{key:"complete",value:function complete(response){if(this.status===_status2["default"].PROGRESS){for(var flow=void 0;flow=this._flows.shift();)flow.abort();this.progress.loaded=this.progress.total,this._session.notify(this.progress),response=this.request.createFileResponse(response),this.setStatus(_status2["default"].END),this.emit(_events2["default"].FILE_UPLOAD_END);var complete=this.context.invoke(_events2["default"].FILE_UPLOAD_COMPLETING,response);this._flows.push(complete),complete.then(this._session.resolve,this._session.reject)}}},{key:"pending",value:function(){(this.status===_status2["default"].ERROR||this.status===_status2["default"].QUEUED)&&(this.progress.total=this.size,this.progress.loaded=0,this.setStatus(_status2["default"].PENDING))}},{key:"abort",value:function(){this._session&&this._session.reject(),this._session=null,this._sessionPromise=null}},{key:"cancel",value:function(){this.setStatus(_status2["default"].CANCELLED),this.emit(_events2["default"].FILE_CANCEL),this.abort(),this.runtime.cancel(this.source),this._dataUrlPromise&&this._dataUrlPromise.abort(),this._md5Promise&&this._md5Promise.abort&&this._md5Promise.abort(),this.removeAllListeners()}},{key:"destroy",value:function(){this.cancel()}}]),File}(_emitter2["default"]);exports["default"]=File,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_jquery=__webpack_require__(3),_jquery2=_interopRequireDefault(_jquery),_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_html5Runtime=__webpack_require__(9),_html5Runtime2=_interopRequireDefault(_html5Runtime),_file=__webpack_require__(12),_file2=_interopRequireDefault(_file),PasteCollector=function(){function PasteCollector(context){_classCallCheck(this,PasteCollector),this.context=context,this.runtime=_html5Runtime2["default"].getInstance()}return _createClass(PasteCollector,null,[{key:"isSupport",value:function(){return"DataTransfer"in window&&"FileList"in window}}]),_createClass(PasteCollector,[{key:"addArea",value:function(area){area=area.on?area:_jquery2["default"](area);var context=this.context,runtime=this.runtime,emitter=new _emitter2["default"],paste=function(e){if(!e.isDefaultPrevented()){var clipboardData=(e.originalEvent||e).clipboardData,items=clipboardData.items,files=clipboardData.files;try{if(!items&&!files||clipboardData.getData("text/html"))return}catch(ex){}var prevent=void 0,i=void 0,l=void 0,file=void 0,item=void 0;if(files&&files.length)for(prevent=files.length>0,i=0,l=files.length;l>i&&!context.isLimit()&&(file=new _file2["default"](runtime,files[i]),prevent=1,!context.add(file)||context.isMultiple());i++);else if(items&&items.length){var filename=clipboardData.getData("text/plain");for(i=0,l=items.length;l>i&&!context.isLimit()&&(item=items[i],"file"!==item.kind||!(file=item.getAsFile())||(file=new _file2["default"](runtime,file,filename),filename=null,prevent=1,!context.add(file)||context.isMultiple()));i++);}prevent&&(e.preventDefault(),e.stopPropagation(),emitter.emit("paste",clipboardData))}};return area.on("paste",paste),emitter.destroy=function(){emitter.removeAllListeners(),area.off("paste",paste)},emitter}}]),PasteCollector}();exports["default"]=PasteCollector,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_jquery=__webpack_require__(3),_jquery2=_interopRequireDefault(_jquery),_emitter=__webpack_require__(2),_emitter2=_interopRequireDefault(_emitter),_html5Runtime=__webpack_require__(9),_html5Runtime2=_interopRequireDefault(_html5Runtime),_flashRuntime=__webpack_require__(15),_flashRuntime2=_interopRequireDefault(_flashRuntime),_file=__webpack_require__(12),_file2=_interopRequireDefault(_file),SWF_URL="",FlashTriggerCollection=function(){function FlashTriggerCollection(context,onFiles){var _this=this;_classCallCheck(this,FlashTriggerCollection);var overlay=_jquery2["default"]("<label></label>");overlay.css({position:"fixed",opacity:0,left:-100,top:-100,width:50,height:50,display:"block",cursor:"pointer",background:"#fff",overflow:"hidden",zIndex:99999});var runtime=new _flashRuntime2["default"](overlay,SWF_URL,function(){return{accept:context.getAccept(),multiple:context.isMultiple()}});runtime.on("select",function(e){onFiles(e.files,runtime),_this.current&&_this.current.emit("files",e.files,runtime)}),runtime.on("rollOut",function(){return _this.hideOverlay()}),this.overlay=overlay.appendTo(document.body)}return _createClass(FlashTriggerCollection,[{key:"hideOverlay",value:function(){this.overlay.css({left:-100,top:-100,width:50,height:50}),this.current&&(this.current.emit("rollOut"),this.current=null)}},{key:"add",value:function(trigger){var _this2=this,overlay=this.overlay,emitter=new _emitter2["default"];return trigger=trigger.on?trigger:_jquery2["default"](trigger),trigger.on("mouseover.flashpicker",function(){var rect=this.getBoundingClientRect();overlay.css({left:rect.left,top:rect.top,width:rect.width,height:rect.height}),emitter.emit("rollOver"),this.current&&this.current!==emitter&&this.current.emit("rollOut"),this.current=emitter}),emitter.destroy=function(){_this2.current===emitter&&_this2.hideOverlay(),emitter.removeAllListeners(),trigger.off("mouseover.flashpicker")},emitter}}]),FlashTriggerCollection}(),Html5TriggerCollection=function(){function Html5TriggerCollection(context,onFiles){var _this3=this;_classCallCheck(this,Html5TriggerCollection);var runtime=_html5Runtime2["default"].getInstance();this._createInput=function(label){var input=_jquery2["default"](document.createElement("input"));input.attr("type","file"),input.css({position:"absolute",clip:"rect(1px 1px 1px 1px)"});var accept=context.getAccept();accept&&accept.length>0&&(accept=accept.map(function(item){return item.mimeTypes}),input.attr("accept",accept.join(","))),context.isMultiple()&&input.attr("multiple","multiple"),input.on("change",function(e){onFiles(e.target.files,runtime),input.remove(),_this3._createInput(label)}),label.html(input)}}return _createClass(Html5TriggerCollection,[{key:"add",value:function(trigger){var label=_jquery2["default"]("<label></label>"),emitter=new _emitter2["default"];return label.css({position:"absolute",opacity:0,top:0,left:0,width:"100%",height:"100%",display:"inline-block",cursor:"pointer",background:"#fff",overflow:"hidden"}),this._createInput(label),trigger=trigger.append?trigger:_jquery2["default"](trigger),trigger.append(label),emitter.destroy=function(){emitter.removeAllListeners(),label.remove()},emitter}}]),Html5TriggerCollection}(),PickerCollector=function(){function PickerCollector(context){_classCallCheck(this,PickerCollector);var onFiles=function(files,runtime){for(var i=0,l=files.length;l>i&&!context.isLimit();i++)context.add(new _file2["default"](runtime,files[i]))};"DataTransfer"in window&&"FileList"in window?this.triggerCollection=new Html5TriggerCollection(context,onFiles):this.triggerCollection=new FlashTriggerCollection(context,onFiles)}return _createClass(PickerCollector,null,[{key:"setSWF",value:function(url){SWF_URL=url}}]),_createClass(PickerCollector,[{key:"addArea",value:function(area){return this.triggerCollection.add(area)}}]),PickerCollector}();exports["default"]=PickerCollector,module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function getFlashVersion(){var version=void 0;try{version=navigator.plugins["Shockwave Flash"],version=version.description}catch(e1){try{version=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e2){version="0.0"}}return version=version.match(/\d+/g),parseFloat(version[0]+"."+version[1])}function callFlash(movie,functionName,argumentArray){try{movie.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray||[],0)+"</invoke>")}catch(ex){throw"Call to "+functionName+" failed"}}function createFlash(swf,callInterface){if(getFlashVersion()<11.4)throw"flash player is not available";var div=document.createElement("div"),url=swf+(swf.indexOf("?")>0?"&":"?")+"callInterface="+encodeURIComponent(callInterface),attrs=['id="'+callInterface+'-Picker"','type="application/x-shockwave-flash"','data="'+url+'"','width="100%" height="100%"','style="position:absolute;left:0;top:0;display:block;z-index:1;outline:0"'];return window.ActiveXObject&&attrs.push('classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"'),div.innerHTML="<object "+attrs.join(" ")+'><param name="movie" value="'+url+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',div.firstChild}function guid(_x4){for(var _again2=!0;_again2;){var prefix=_x4;ret=void 0,_again2=!1;var ret=prefix+(_guid++).toString(16);if(!(ret in window))return ret;_x4=prefix,_again2=!0}}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function(_x,_x2,_x3){for(var _again=!0;_again;){var object=_x,property=_x2,receiver=_x3;desc=parent=getter=void 0,_again=!1,null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0!==desc){if("value"in desc)return desc.value;var getter=desc.get;return void 0===getter?void 0:getter.call(receiver)}var parent=Object.getPrototypeOf(object);if(null===parent)return void 0;_x=parent,_x2=property,_x3=receiver,_again=!0}},_runtime=__webpack_require__(10),_runtime2=_interopRequireDefault(_runtime),_transport=__webpack_require__(16),_transport2=_interopRequireDefault(_transport),_guid=+new Date,FlashRuntime=function(_Runtime){function FlashRuntime(trigger,swf,options){var _this=this;_classCallCheck(this,FlashRuntime),_get(Object.getPrototypeOf(FlashRuntime.prototype),"constructor",this).call(this);var callInterface=guid("FlashRuntime");this.callInterface=callInterface,window[callInterface]=this,this.options=options;var display=function display(){var w=trigger[0].offsetWidth,h=trigger[0].offsetHeight,flash=void 0;return w&&h&&(flash=createFlash(swf,callInterface))?void trigger.append(_this.flash=flash):void setTimeout(display,1e3)};display()}return _inherits(FlashRuntime,_Runtime),_createClass(FlashRuntime,[{key:"getOptions",value:function(){var options=this.options;return"function"==typeof options&&(options=options()),options}},{key:"getTransport",value:function(name,blob,options){return new _transport2["default"](this,name,blob,options)}},{key:"send",value:function(name,blob,url,params){callFlash(this.flash,"exec",["send",name,blob.id,url,params])}},{key:"abort",value:function(blob){try{callFlash(this.flash,"exec",["abort",blob.id])}catch(e){}}},{key:"cancel",value:function(blob){callFlash(this.flash,"exec",["cancel",blob.id])}},{key:"ping",value:function(){callFlash(this.flash,"exec",["pang"])}},{key:"destroy",value:function(){delete window[this.callInterface]}}]),FlashRuntime}(_runtime2["default"]);exports["default"]=FlashRuntime,
module.exports=exports["default"]},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_errors=__webpack_require__(6),_jquery=__webpack_require__(3),FlashTransport=function(){function FlashTransport(flashRuntime){_classCallCheck(this,FlashTransport),this.flashRuntime=flashRuntime}return _createClass(FlashTransport,[{key:"generate",value:function(request){var i=_jquery.Deferred(),flashRuntime=this.flashRuntime,blob=request.getBlob(),timeoutTimer=void 0,clean=function(){flashRuntime.off("uploadprogress",progress),flashRuntime.off("uploadcomplete",complete),flashRuntime.off("uploaderror",error),timeoutTimer&&clearTimeout(timeoutTimer)},abort=function(){clean(),flashRuntime.abort(blob.id)},progress=function(e){e.id===blob.id&&i.notify(e)},complete=function(e){return e.id===blob.id?(clean(),304===e.status||e.status>=200&&e.status<300?(flashRuntime.cancel(blob),i.resolve(e.response)):i.reject(new _errors.NetworkError(e.status,e.response))):void 0},error=function(e){e.id===blob.id&&(clean(),i.reject(new _errors.AbortError(e.message)))};flashRuntime.on("uploadprogress",progress),flashRuntime.on("uploadcomplete",complete),flashRuntime.on("uploaderror",error);var timeout=request.getTimeout();timeout>0&&(timeoutTimer=setTimeout(function(){abort(),i.reject(new _errors.TimeoutError("timeout:"+timeout))},timeout));try{flashRuntime.send(request.getName(),blob,request.getUrl(),request.getParams().toString())}catch(e){abort(),i.reject(new _errors.AbortError(e.message))}var ret=i.promise();return ret.abort=abort,ret}}]),FlashTransport}();exports["default"]=FlashTransport,module.exports=exports["default"]}]);UXUploader["default"].setSWF(require.resolve("./flashpicker.swf#")),UXUploader["default"].Status=UXUploader.Status,UXUploader["default"].Events=UXUploader.Events,module.exports=UXUploader["default"]});
//# sourceMappingURL=uploader.js.map